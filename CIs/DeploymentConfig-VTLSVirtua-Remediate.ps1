Import-Module AppvClient
$PackageID = "51235754-60a7-47ac-bdaa-2d06e30e5dd3"
$VersionID = "1b3c9da9-b3a8-453c-9404-869126c680a5"

$NewConfigFile = @"
<?xml version="1.0"?>
<DeploymentConfiguration PackageId="51235754-60a7-47ac-bdaa-2d06e30e5dd3" DisplayName="VTLS_Virtua_12.12_APPV_Restricted_WKS" xmlns="http://schemas.microsoft.com/appv/2010/deploymentconfiguration"><UserConfiguration><Subsystems><Shortcuts Enabled="true"><Extensions><Extension Category="AppV.Shortcut"><Shortcut><File>[{Common Programs}]\VTLS\Virtua 2012.2 x64 Rev 4.lnk</File><Target>[{AppVPackageRoot}]\virtua.exe</Target><Icon>[{AppVPackageRoot}]\virtua.exe.0.ico</Icon><Arguments></Arguments><WorkingDirectory></WorkingDirectory><ShowCommand>1</ShowCommand><ApplicationId>[{AppVPackageRoot}]\virtua.exe</ApplicationId></Shortcut></Extension></Extensions></Shortcuts><FileTypeAssociations Enabled="true"></FileTypeAssociations><URLProtocols Enabled="true"></URLProtocols><AppPaths Enabled="true"><Extensions><Extension Category="AppV.AppPath"><AppPath><Name>bantam.dll</Name><ApplicationPath>bantam.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>bdeadmin.cpl</Name><ApplicationPath>bdeadmin.cpl</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix><ApplicationId>bdeadmin.cpl</ApplicationId></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>bdeadmin.exe</Name><ApplicationPath>bdeadmin.exe</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix><ApplicationId>bdeadmin.exe</ApplicationId></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>bdeadmin.hlp</Name><ApplicationPath>bdeadmin.hlp</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>blw32.dll</Name><ApplicationPath>blw32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>disp.dll</Name><ApplicationPath>disp.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idapi32.dll</Name><ApplicationPath>idapi32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idasci32.dll</Name><ApplicationPath>idasci32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idbat32.dll</Name><ApplicationPath>idbat32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idda3532.dll</Name><ApplicationPath>idda3532.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>iddao32.dll</Name><ApplicationPath>iddao32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>iddbas32.dll</Name><ApplicationPath>iddbas32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>iddr32.dll</Name><ApplicationPath>iddr32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idodbc32.dll</Name><ApplicationPath>idodbc32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idpdx32.dll</Name><ApplicationPath>idpdx32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idqbe32.dll</Name><ApplicationPath>idqbe32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idr20009.dll</Name><ApplicationPath>idr20009.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension><Extension Category="AppV.AppPath"><AppPath><Name>idsql32.dll</Name><ApplicationPath>idsql32.dll</ApplicationPath><PATHEnvironmentVariablePrefix>[{AppVPackageRoot}]\</PATHEnvironmentVariablePrefix></AppPath></Extension></Extensions></AppPaths><COM Mode="Integrated"><IntegratedCOMAttributes OutOfProcessEnabled="true" InProcessEnabled="false"></IntegratedCOMAttributes></COM><Objects Enabled="false"></Objects><Registry Enabled="true"></Registry><FileSystem Enabled="true"></FileSystem><Fonts Enabled="true"></Fonts><EnvironmentVariables Enabled="true"></EnvironmentVariables><Services Enabled="true"></Services></Subsystems><Applications><Application Id="[{AppVPackageRoot}]\virtua.exe" Enabled="true"><VisualElements><Name>Virtua</Name><Icon></Icon><Description></Description></VisualElements></Application><Application Id="bdeadmin.cpl" Enabled="true"><VisualElements><Name>bdeadmin</Name><Icon></Icon><Description></Description></VisualElements></Application><Application Id="bdeadmin.exe" Enabled="true"><VisualElements><Name>bdeadmin</Name><Icon></Icon><Description></Description></VisualElements></Application></Applications></UserConfiguration><MachineConfiguration><ProductSourceURLOptOut Enabled="true"></ProductSourceURLOptOut><Subsystems><Registry></Registry></Subsystems><TerminateChildProcesses></TerminateChildProcesses></MachineConfiguration></DeploymentConfiguration>
"@

$NewConfigFile = $NewConfigFile.Trim()
$NewConfigPath = New-Item -Path $env:Temp -Name (Get-Random) -ItemType File -Value $NewConfigFile
Set-AppvClientPackage -PackageId $PackageID -VersionId $VersionID -DynamicDeploymentConfiguration $NewConfigPath
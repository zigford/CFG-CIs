Import-Module AppvClient
$PackageID = "bd05edab-bfdb-499f-94ac-6c36770eb138"
$VersionID = "d0bc751c-ae6a-4b6a-93d7-62e28aa6102e"

$NewConfigFile = @"
<?xml version="1.0"?>
<DeploymentConfiguration PackageId="bd05edab-bfdb-499f-94ac-6c36770eb138" DisplayName="Allegorithmic_Substance Painter_2018.3.2-2768-msvc14-x64-standard-full_APPV_Floating_WKS-USR" xmlns="http://schemas.microsoft.com/appv/2010/deploymentconfiguration"><UserConfiguration><Subsystems><Shortcuts Enabled="true"><Extensions><Extension Category="AppV.Shortcut"><Shortcut><File>[{Common Programs}]\Allegorithmic\Substance Painter\Substance Painter v2018.3.2.0.lnk</File><Target>[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe</Target><Icon>[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe.0.ico</Icon><Arguments></Arguments><WorkingDirectory>[{ProgramFilesX64}]\Allegorithmic\Substance Painter</WorkingDirectory><ShowCommand>1</ShowCommand><ApplicationId>[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe</ApplicationId></Shortcut></Extension></Extensions></Shortcuts><FileTypeAssociations Enabled="true"><Extensions><Extension Category="AppV.FileTypeAssociation"><FileTypeAssociation><FileExtension MimeAssociation="false"><Name>.spp</Name><ProgId>SubstancePainterProject</ProgId></FileExtension><ProgId><Name>SubstancePainterProject</Name><Description>Substance Painter Project</Description><DefaultIcon>[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe.0.ico</DefaultIcon><ShellCommands><ShellCommand><ApplicationId>[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe</ApplicationId><Name>open</Name><CommandLine>"[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe" "%1"</CommandLine></ShellCommand></ShellCommands></ProgId></FileTypeAssociation></Extension></Extensions></FileTypeAssociations><URLProtocols Enabled="true"></URLProtocols><COM Mode="Isolated"><IntegratedCOMAttributes OutOfProcessEnabled="true" InProcessEnabled="false"></IntegratedCOMAttributes></COM><Objects Enabled="true"></Objects><Registry Enabled="true"></Registry><FileSystem Enabled="true"></FileSystem><Fonts Enabled="true"></Fonts><EnvironmentVariables Enabled="true"></EnvironmentVariables><Services Enabled="true"></Services></Subsystems><Applications><Application Id="[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe" Enabled="true"><VisualElements><Name>Substance Painter v2018.3.2.0</Name><Icon></Icon><Description></Description></VisualElements></Application></Applications><UserScripts><StartProcess RunInVirtualEnvironment="true"><Path>PowerShell.exe</Path><Arguments>-WindowStyle Hidden -NoProfile -EncodedCommand JABMAGkAYwBlAG4AcwBlAFAAYQB0AGgAIAA9ACAAIgAkAHsARQBuAHYAOgBMAG8AYwBhAGwAQQBwAHAARABhAHQAYQB9AFwAQQBsAGwAZQBnAG8AcgBpAHQAaABtAGkAYwBcAFMAdQBiAHMAdABhAG4AYwBlACAAUABhAGkAbgB0AGUAcgAiADsAIAAkAEwAaQBjAGUAbgBzAGUAUABhAHkAbABvAGEAZAAgAD0AIAAnAHsAIgBwAGEAeQBsAG8AYQBkACIAOgAiAGUAeQBKAHIAWgBYAGsAaQBPAGkASgBtAFoARABrADMATgBtAE4AaQBZAG0AWQA1AE0AMgBKAGgATQAyAFoAawBNAFQAZABpAFoAaQBJAHMASQBtADEAaABlAEYAOQBoAFkAMwBSAHAAZABtAEYAMABhAFcAOQB1AGMAeQBJADYATQBqAEEAcwBJAG0AaABoAGMAbQBSADMAWQBYAEoAbABYADIAbABrAEkAagBwAHUAZABXAHgAcwBMAEMASgBsAGUASABCAHAAYwBtAEYAMABhAFcAOQB1AFgAMgBSAGgAZABHAFUAaQBPAG0ANQAxAGIARwB3AHMASQBtADEAaABhAFcANQAwAFoAVwA1AGgAYgBtAE4AbABYADIAVgB1AFoARgA5AGsAWQBYAFIAbABJAGoAbwBpAE0AagBBAHkATQBDADAAdwBNAGkAMAB3AE4AVgBRAHcATQBEAG8AdwBNAEQAbwB3AE0AQwA0AHcATQBEAEIAYQBJAGkAdwBpAFkAbgBWAHAAYgBHAFIAZgBkAG0AVgB5AGMAMgBsAHYAYgBpAEkANgBiAG4AVgBzAGIAQwB3AGkAYwAyADkAbQBkAEgAZABoAGMAbQBWAGYAYQBXAFEAaQBPAGoARQBzAEkAbgBWAHoAWgBYAEkAaQBPAG4AcwBpAFoAVwAxAGgAYQBXAHcAaQBPAG0ANQAxAGIARwB4ADkATABDAEoAdwBjAG0AOQBrAGQAVwBOADAASQBqAHAANwBJAG0ANQBoAGIAVwBVAGkATwBpAEoAVABkAFcASgB6AGQARwBGAHUAWQAyAFUAZwBVAEcARgBwAGIAbgBSAGwAYwBpAEEAdABJAEUAVgBrAGQAVwBOAGgAZABHAGwAdgBiAGkAQgBNAGEAVwBOAGwAYgBuAE4AbABJAG4AMABzAEkAbgBOAHYAWgBuAFIAMwBZAFgASgBsAEkAagBwADcASQBtADUAaABiAFcAVQBpAE8AaQBKAFQAZABXAEoAegBkAEcARgB1AFkAMgBVAGcAVQBHAEYAcABiAG4AUgBsAGMAaQBKADkATABDAEoAMgBaAFgASgB6AGEAVwA5AHUASQBqAG8AegBmAFEAPQA9ACIALAAiAGsAZQB5ACIAOgAiAGoASwAwAE4AZABpAEIAbAAzAGgAeAA0AEMASwBLAHkAVgBjAGQAagBkAEcAKwBHADkARQBtAFIAegBjAFYAaABrAHkATgA3AG0AdQBpAHoAWABwACsASQBhAGoAVwBXAGYARAA4AFQAbABFAGYAMQBMAEcAWQBaAC8AbABqAHIAawBFAFAAbgA4ADEAZABNACsASgBnAE0AZwA5AFMANQBaAFYAdwB0AG8AZgA3AHgAUwA1AEcAbAA1AHYAZwByAFYAaAB1AGMAdABUADkAbQArAHYALwBtAEkAVwBqAGgAYgBuAFAAQQBEAEIALwBrACsARgBYAEcAUQArAHoANwBEAGkAdABtAHEARAAvAEoAZwBqAFMAQgBHAG0AaABHAHAAaABkADgARgAxAGcATABlADQATQBQAFQAOQAvADkATwBMAGwARAByAEEAUgBuADYAWQBDAG4AdQBXAEYATgA3ADYAYQA3ADAALwB1AHoAZgBCAEkAZAA5AFAAdgB0ADEATQBaAFYAVgBIAGQATgBZAGUAWABUAG4AYwAvAE8ATABKAEYARwAyAEsAbwB3ADMAdAAyAGgAWQBLAE0ATgBwAFcAWgBIAHMANAB1AEEAMwB3AGoAYgBMAHkAcQAwADIAZwA1AEoAYQB0AG0AQQBMADgAQQBlAGIAZQBjAHUAaQBGAFIANgBUADgAegA4ADMATQBsAEMAcwBPAFYATQBxADYATgBZADMAQQB5AHMASABYADYAQgBOAG4AUwByAE8AOAA0AGcAaABLAHYAUgBUAGUAUwBYAHoAcwBmAGIARABQADcAZgA3AHQANgA5AFIAWgBHAEsAYgBwAEIANABuAC8AWgBJAHMAMQBkADIATAAvAEoATQB0AHkATABXAG8AQwA3AGUASQAxAHAARABlADYAagBqAE0AUABiAEIAYgBCAHkAVQBlAHUAVQBLAFAARwBpADUAcwBFAEMASAB5AGsAcABwADgAWABVAFgAVQBxAEwANQBSAEkASABuADMANABhAGgAUAAyAGUAdQBjADgAWQB0AGEAdwBvAFcALwBzAGoAawBIAEsAegBsAHAASgBZAGUARQAzAEUAMgBHAHoAdQBqAG0AaABLAEMAbQAvAFcAQwBvAHEAWgBiAE0ASwA4AFoANwBMAGYARQBCAHcAVQBWAG0AQgBWAGoAdABjADQATwBBAC8AQgBTAFAANABEAGEAaABSAGQAMQBFAEsAaQBNAGoATwBvADAAZQA5AFkAdwBUAEoARgBFAFYAbQBrAGsARABZAEoAbABWAFkAcwB0AEQAMQBuADYAMABWADMAYwBSACsAVQA2ADkAZwBDAFIAdgAvAEQAMwB0AFQAQwBIAEwAMQBjAFEAZwBwAHEAVABiADAAcgB1AHYAdQBEAEMAWQBkAHcAaQBIAG8AbgA1AGUAYgBKAEMAZgB0AEQANQA5AFQAOQAxAFgAZAB4AHMAagAvAFMAWQBTAEEARQBmAFgAegBjAGwAQwBKAEUAeQBaAFkAWQBYAEgAeQAyAE4AcQA3AEgAdAAzADMAMQBxAE4AeQBkAFYAaABZAGgAYwBxAFoAMwBkAEIAbgAyAFkAVwBiAGcAVQBMAEUAagBZAHcAMABXAGMAZABpADgAeAAvAG8AVQBQADgAbABYAHYAdQA0AHIAeAAwADQAYgByACsASgA5AE0AcAArAEQAbQA5AGoATQBKAGQAUwB4AHgAMQBvAEEAdwBlADEASwBDAHEATgA2ADMAbgBSAEwASABmAHIANgBNADEARABrAG8ASgAvAHYAWQAwAGUAYwA9ACIAfQAnADsAIABJAGYAIAAoAC0ATgBvAHQAIAAoAFQAZQBzAHQALQBQAGEAdABoACAALQBQAGEAdABoACAAIgAkAEwAaQBjAGUAbgBzAGUAUABhAHQAaABcAGwAaQBjAGUAbgBzAGUALgBrAGUAeQAiACkAKQAgAHsAIAAgACAAIAAgAE4AZQB3AC0ASQB0AGUAbQAgAC0ASQB0AGUAbQBUAHkAcABlACAARgBpAGwAZQAgAC0AUABhAHQAaAAgACQATABpAGMAZQBuAHMAZQBQAGEAdABoACAALQBOAGEAbQBlACAAIgBsAGkAYwBlAG4AcwBlAC4AawBlAHkAIgAgAGAAIAAgACAAIAAgACAAIAAgACAALQBWAGEAbAB1AGUAIAAkAEwAaQBjAGUAbgBzAGUAUABhAHkAbABvAGEAZAAgAC0ARgBvAHIAYwBlADsAIAB9ADsAIAAgACQAUwBQAEsAZQB5ACAAPQAgACcASABLAEMAVQA6AFwAUwBvAGYAdAB3AGEAcgBlAFwAQQBsAGwAZQBnAG8AcgBpAHQAaABtAGkAYwBcAFMAdQBiAHMAdABhAG4AYwBlACAAUABhAGkAbgB0AGUAcgBcAEcAZQBuAGUAcgBhAGwAJwA7ACAASQBmACAAKAAtAE4AbwB0ACAAKABUAGUAcwB0AC0AUABhAHQAaAAgAC0AUABhAHQAaAAgACQAUwBQAEsAZQB5ACkAKQAgAHsAIAAgACAAIAAgAE4AZQB3AC0ASQB0AGUAbQAgACQAUwBQAEsAZQB5ACAALQBGAG8AcgBjAGUAIAAtAEkAdABlAG0AVAB5AHAAZQAgAEQAaQByAGUAYwB0AG8AcgB5ADsAIAB9ADsAIABTAGUAdAAtAEkAdABlAG0AUAByAG8AcABlAHIAdAB5ACAALQBQAGEAdABoACAAJABTAFAASwBlAHkAIAAtAE4AYQBtAGUAIAAnAEMASABFAEMASwBfAEYATwBSAF8AVQBQAEQAQQBUAEUAUwAnACAALQBWAGEAbAB1AGUAIAAnAGYAYQBsAHMAZQAnACAALQBGAG8AcgBjAGUAOwA=</Arguments><Wait RollbackOnError="false"></Wait><ApplicationId>[{ProgramFilesX64}]\Allegorithmic\Substance Painter\Substance Painter.exe</ApplicationId></StartProcess></UserScripts></UserConfiguration><MachineConfiguration><ProductSourceURLOptOut Enabled="true"></ProductSourceURLOptOut><Subsystems><Registry></Registry></Subsystems><TerminateChildProcesses></TerminateChildProcesses></MachineConfiguration></DeploymentConfiguration>
"@

$pkg = Get-AppvClientPackage -PackageId $PackageID -VersionId $VersionID
$ConfigPath = $pkg.GetDynamicDeploymentConfigurationPath()
$CurrentConfigFile = (Get-Content $ConfigPath -Raw)

$CurrentConfigFile = $CurrentConfigFile.Trim()
$NewConfigFile = $NewConfigFile.Trim()
$CurrentConfigFile | Out-File -FilePath "$($env:TEMP)\Current.log"
$NewConfigFile | Out-File -FilePath "$($env:TEMP)\New.log"

$NewConfigFile = Get-Content -Path "$($env:TEMP)\New.log"
$CurrentConfigFile = Get-Content -Path "$($env:TEMP)\Current.log"

If (Compare-Object $NewConfigFile $CurrentConfigFile) {
    $False
} Else {
    $True
}
